# Личный DevOps-Дневник

---

## 1 Августа 2025

> Не знаю как правильно записать: продолжить с момента или описать с начала?
> 
> **В моменте:**
> На этой неделе у меня получилось собрать свой Playbook на **Ansible**, который компилирует модули **GeoIP2** и **ModSecurity**, устанавливает **Nginx** и всё это красиво прописывает в настройки.
> 
> Есть ещё многое, что нужно узнать про Ansible, но сейчас самому себя перегружать не нужно. Пока не знаю, что дальше, поэтому думаю попробовать подружиться с **GitLab**.
> 
> **Ситуация:**
> Нужно установить **Nginx Mainline 1.29** (последняя версия). Для этого:
> 
> 1. Установка Legacy 1.24
> 2. Копирование нужных файлов из него
> 3. Установка 1.29 и присваивание структуры, как у 1.24

---

## 4 Августа 2025

### Задача

1. **Собрать вручную сборку Nginx из исходников.**
   Установил Legacy-версию, чтобы скопировать часть конфигов в Mainline-версию.
   
   * ✅ Собрал успешно

2. **Собрать, установить, запустить, проверить работоспособность.**
   
   * Задача:
     
     * Установить версию **1.28.0** (main Playbook)
     * Сделать апдейт до **1.29.0** (update Playbook)

3. **Заделиверить через Playbook.**

---

**Результат:**
С самого утра пытаюсь собрать Playbook — миллиард ошибок.
Решаю начать с нуля.

---

**Задача: 8/4/2025 16:30**

1. Скачать **Nginx Mainline v1.29.0**, создать `nginx.service`
2. Собрать модули **GeoIP2** и **ModSecurity** на базе Nginx 1.29.0

Делаю шаг за шагом: пока не подтвержу работоспособность — дальше не иду.

#### Структура:

* `nginx-laravel-main.yml`
* `prx_hosts.yml`
* `/vars/main.yml`
* `/roles/ngx-build-and-modules/main.yml`

---

## 5 Августа 2025

1. Начал собирать чистую сборку, но не нравится бинарник.
   Перехожу в ручной режим.

> **Объяснение:**
> Все таски "сборка Nginx" и "build GeoIP2" делаются за один configure/make, без повторного configure!
> Удалена вторая сборка исходников, только один configure/make.
> `make clean || true` — если первый раз, не упадёт.
> Модуль гарантированно совместим.
> После этого можно сразу переходить к ModSecurity или другим модулям.
> Используй такой playbook — и “binary incompatible” исчезнет навсегда!
> Если нужны мелкие правки или разбить таски — скажи, подправлю.

---

**10:13** — Playbook собрался успешно?
Буду добавлять Laravel и проверять:

1. `/etc/nginx/nginx.conf` — добавить GeoIP2
2. Скопировать конфиг Laravel
   2.1. Создать линк на sites-enabled
3. В Laravel добавить (ModSecurity, add\_headers)

---

**Решение:**

* Прописал копирование чистого `nginx.conf` до загрузки модулей.
* Всё работает как нужно!

---

**Финалка:**
Я собрал свой **Nginx from Source Code + ModSecurity + GeoIP2**!

---

## 6 Августа 2025

1. Задал себе вопрос — как обновлять такую сборку через Playbook?

2. **Тест 1:** Установка 1.28, потом просто замена версии в vars на 1.29 — и проверка.
   
   * **8:20** — Деплой версии 1.28 прошёл успешно
   * **8:35** — Заменяю vars на 1.29, проверяю
   * **8:40** — Апдейт прошёл успешно! С 1.28 на 1.29.
     **Победа!**

---

## 7  Августа 2025

1. Берусь основательно за "Git". База и практика. Иду по предложению Chat-a.
2. Отвлекся "Как сделать WSL красивее". 
3. Этот .git = боль,  я потратил много времени на него сегодня, но - как мне кажется я понял. 
   `В кратце. У нас есть main, с него все и качают. Если ты что то делаешь - добавляшь, то обязательно делаешь ветвь отдельную. И когда ты уверен что всё гуд, merge.`

## 8 Августа 2025

1. ADV-IT = Курс GitLab CI/CD, Pipeline (взялся, тяжело понять только по видео - но буду учиться)
   Много разного, тяжело что-то взять. В основном в уроках на AWS, и много разных технологий которые мне ещё ранно?
2. Через чат прогнал идеи мини-проектов CI/CD через GitLab
3. Получил таск - переделать Playbook (dynamic modules) --> (static modules) = Done

## 11 Августа 2025

1. Думаю вывести в CI CD уже проделанною работу (laravel, db и остальное) ....

## 12 Августа 2025

1. Задача на сегодня: Сделать текствовый CI / CD на GitLab. Runner на сервере 10.100.93.6
   Я сделал Pipeline на GitLab, на внутренем Runner. Он просто печатает инфу. 
   Иду дальше, пробую ставить Runner на сервер, и делать через него. 

## 13 Августа 2025

Начал по порядку, установка и настройка Runner -> Понять глубже про CI -> По пробовать визуализировать Laravel Ci Cd
Сбился чуть с путь, решил сделать playbook по update-upgrade на серверах = естественно не без помощи чата
Пытался подключть Runner, от https://git-dev.itsec.md  не выходит, больше похоже что сетевая ошибка.
Открыл даже port 443 for Public IP - не помогло
`Решение: git-dev.itsec.md имеет ACL (Access control list) - туда разрешили мой Public IP`
Никогда не забывай про tags:[yourRunner]
....
*Что сегодня у меня получилось*
Я взял проект с Git, на Laravel, и с помощью GPT скажем задеплоил его. В конечно итоге, у меня открылся сайт. Какой никакой.

## 14 Августа

Что я буду делать сегодня?

1. Сделать *Recap* and **GUIDE** по развёртыванию проекта Laravel
2. Сделать на 93.6 server ещё одно (возможно другого проекта) с нуля
3. Сделать развёртывание через **Docker**
4. CD из пункта **2**
5. Ci/Cd из пункта **3**

Сегодня я сделал пункты: 1 и 2.

## 15 Августа

Делаю пукнт 4. 
В конце рабочего дня успешно сделал Deploy через Git -> используя Ansible Playbook, смог установить нужные Dependecies. 

## 18 Авгуса

Продолжил по той же концепции, пытался делать через Playbook, и к какому выводу пришёл:

1. Развёртывание Laravel project, я делал в ручную, по этому сейчас у меня столько факапов.
2. Если хочу продолжить playbook-ами, то не ебаться через Гит, а сначала локально развернуть через Ansible. 
3. Мог просто развернуть код через CI / CD.

Что я буду делать дальше: По пробую пункт **3** для начала, потом перейду к *2*.

## 20 Августа 2025
**2 Пункт** с *14 Августа* был выполнен успешно. Был сделан цельный Pipeline с 6 [Stages], используя только линукс код и скриптинг.
(D:\s_Dev\Laralvel Project\Deploy Git-Dev Laravel Project(unix).yml)
!!! Закончить с **Workflow:Rules** для *Pipeline*.
Следующие этапы:
3. Сделать развёртывание через **Docker**
5. Ci/Cd из пункта **3**

-----------------------------------------

Day 21 August [Continues Integragtion]
-----------------------------------------
Сегодня 21 Августа, Четверг. 
Планирую к концу недели (завтар 17:00) сделать делпой проекта на Larave через Docker. 
Для этого нужно решить:
1. Делаю в ручну используя Docker и потом Deploy Git 
2. Или срвзу Deploy Git ?
--- **Ответ узнаю когда это сделаю**
### Ещё один вопрос: Как понять что мне нужно?
##### А) Git Docker = типо использовать контейнер, и развернуть Project
##### В) Весь Project, залить в контейнер и развренуть через Git?
#### Кажется я нашёл ответ?!
```
Что это вообще такое. *Разверунть Проект на Ларавел через Докер*?!
Это, когда ты используешь вопервых архитектуру контейнеризации, что в будующем упрощят работу с разными типов серверо, ОС, быстрой развёрнутости и удаление и тд. Дальше, по мимо того что ты исопльзуешь уже готовый контейнр, ты его также можешь доработать под свои нужды, таким образом - ты уже имеешь не просто контейнер *nginx* а и уже некие преднастроки. 
```
-----------------------------------------

Day 22 August [Continues Integragtion]
-----------------------------------------
#### Morning Agent. Let's recap a little about your day of yesturday. 
I thought, I understand what is CI/CD Laravel Project usig Docker.
Also, yesturday I found out how to connect VS Code to one of my servers,
using SSH Connect, and how to provide access to all my repositories. 

##### Today
I will do Laravel Project, directly on server using **docker-compose**.
*to be continued ...*
### Terrible things.
I am stuck in progress. I don't understand why and what I am doing.
Started study docker compose from scratch with GPT.