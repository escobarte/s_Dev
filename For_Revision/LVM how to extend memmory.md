
# Как увеличить место для LVM-раздела PostgreSQL

---

## 0. Исходные данные

- Диск: `/dev/sdb` (30G)
- Основной раздел LVM для PostgreSQL: `/dev/mapper/DATA-psql`, смонтирован в `/var/lib/postgresql`, почти заполнен (93%)
- Нужно добавить место из неразмеченной области диска

---

## 1. Проверка свободного места и структуры диска

```bash
parted /dev/sdb print free         # Показывает свободное место на диске
lsblk                              # Структура разделов и LVM
df -hT                             # Проверить точки монтирования и занятое место
```

---

## 2. Создать новый раздел на свободном месте

```bash
fdisk /dev/sdb

# Пример действий:
# n      # создать новый раздел
# (номер, по умолчанию — sdb5)
# t      # изменить тип
# 8e     # Linux LVM
# w      # сохранить и выйти
```

---

## 3. Применить изменения разделов

```bash
partprobe                          # Применить изменения таблицы разделов
```

---

## 4. Инициализировать новый Physical Volume для LVM

```bash
pvcreate /dev/sdb5                 # Сделать новый раздел PV
```

---

## 5. Расширить Volume Group

```bash
vgextend DATA /dev/sdb5            # Добавить новый PV к VG (у тебя VG называется DATA)
```

---

## 6. Увеличить Logical Volume

```bash
lvextend -l +100%FREE /dev/DATA/psql   # Использовать всё свободное VG пространство для LV "psql"
```
*Пояснение: `-l +100%FREE` — взять всё доступное свободное место из VG.*

---

## 7. Расширить файловую систему ext4 на LV

```bash
resize2fs /dev/mapper/DATA-psql
```

---

## 8. Проверить результат

```bash
df -hT | grep psql
lsblk
```
**Пример результата:**
```
/dev/mapper/DATA-psql ext4   11G  4.3G  5.7G  43% /var/lib/postgresql
```

---

### Итог

- LVM-раздел увеличен и файловая система расширена, место стало доступно для PostgreSQL без потери данных.
- Все операции можно выполнять на "живой" файловой системе (но всегда лучше иметь резервную копию!).

