---
 - name: DBserver Setup
   hosts: all
   become: yes
   vars:
     dbname: GoldenState
     dbuser: StephCurry
   tasks:
      - debug:
          msg: "The current team is {{dbname}}"
      - debug:
          msg: dbuser

      - name: Install mysql-server and PyMySQL
        apt:
          name: 
            - mysql-server
            - python3-pymysql
          state: present

      - name: start and enable
        service:
          name: mysql
          state: started
          enabled: yes

      - name: Create a new database with name 'accoounts'
        community.mysql.mysql_db:
          name: accounts
          state: present
          login_unix_socket: /run/mysqld/mysqld.sock

      - name: Create database user with name 'Serge' and password 'admin' with all database privileges
        community.mysql.mysql_user:
          name: "{{dbname}}"
          password: 'admin'
          priv: '*.*:ALL'
          state: present
          login_unix_socket: /run/mysqld/mysqld.sock
