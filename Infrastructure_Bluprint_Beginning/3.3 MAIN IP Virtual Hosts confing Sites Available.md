# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–æ–∫—Å–∏ –¥–ª—è Laravel –∏ Zabbix —á–µ—Ä–µ–∑ NGINX

## –¶–µ–ª—å

–û—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—é —á–µ—Ä–µ–∑ NGINX:
- `laravel.lab.local` ‚Üí Laravel-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ app01, app02, app03
- `zabbix.lab.local` ‚Üí Zabbix-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ app03 (10.100.93.7/zabbix)

---

## üó∫Ô∏è –°—Ö–µ–º–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏

```text
–ö–ª–∏–µ–Ω—Ç
 ‚îú‚îÄ> laravel.lab.local   ‚Üí NGINX Proxy ‚Üí App01/App02/App03 (Laravel)
 ‚îî‚îÄ> zabbix.lab.local    ‚Üí NGINX Proxy ‚Üí App03 (Zabbix)
```

---

## 1. NGINX –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (–Ω–∞ 10.100.93.3)

–°–æ–∑–¥–∞–Ω—ã –Ω–æ–≤—ã–µ —Ñ–∞–π–ª—ã:

- `/etc/nginx/sites-available/laravel.lab.local.conf`
- `/etc/nginx/sites-available/zabbix.lab.local.conf`

### üîß Zabbix –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
```nginx
# –û–ø—Ä–µ–¥–µ–ª—è–µ–º upstream —Å–µ—Ä–≤–µ—Ä Zabbix
upstream zabbix_backend {
    server 10.100.93.7 max_fails=1 fail_timeout=1s;  # IP App03, –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –æ—Ç–∫–∞–∑–æ–≤
}

# HTTPS-—Å–µ—Ä–≤–µ—Ä –¥–ª—è zabbix.lab.local
server {
    listen 443 ssl;                                # –°–ª—É—à–∞–µ–º HTTPS
    server_name zabbix.lab.local;                  # –î–æ–º–µ–Ω–Ω–æ–µ –∏–º—è

    location / {
        proxy_pass http://zabbix_backend/zabbix/;  # –ü—Ä–æ–∫—Å–∏—Ä—É–µ–º –Ω–∞ App03 —Å /zabbix
        proxy_cookie_path /zabix /;                # –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –ø—É—Ç–∏ cookie
    }

    # ssl_certificate, ssl_certificate_key –∏ –¥—Ä. –ø–∞—Ä–∞–º–µ—Ç—Ä—ã ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –æ—Ç app.lab.local
}
```

---

## 2. –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –∏ —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö —Å–∏–º–ª–∏–Ω–∫–æ–≤
```bash
rm /etc/nginx/sites-enabled/*                                       # –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–µ —Å—Å—ã–ª–∫–∏
ln -s /etc/nginx/sites-available/laravel.lab.local.conf /etc/nginx/sites-enabled/  # –õ–∞—Ä–∞–≤–µ–ª
ln -s /etc/nginx/sites-available/zabbix.lab.local.conf /etc/nginx/sites-enabled/  # –ó–∞–±–±–∏–∫—Å

nginx -t && systemctl reload nginx                                  # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫
```

---

## üîç –ü—Ä–æ–±–ª–µ–º–∞ –∏ —Ä–µ—à–µ–Ω–∏–µ —Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π Zabbix

**–ü—Ä–æ–±–ª–µ–º–∞:** Zabbix –Ω–µ –ª–æ–≥–∏–Ω–∏–ª—Å—è, —Ç–∞–∫ –∫–∞–∫ –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–ª—Å—è –Ω–∞ `/zabbix`, –∞ cookie —Å–æ—Ö—Ä–∞–Ω—è–ª–∞—Å—å –Ω–∞ –¥—Ä—É–≥–æ–º —É—Ä–æ–≤–Ω–µ.

**–†–µ—à–µ–Ω–∏–µ:** –¥–æ–±–∞–≤–ª–µ–Ω–∞ —Å—Ç—Ä–æ–∫–∞:
```nginx
proxy_cookie_path /zabix /;
```
